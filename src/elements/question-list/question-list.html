<link rel="import" href="../../../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../../bower_components/paper-material/paper-material.html">
<link rel="import" href="../../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../../bower_components/paper-radio-button/paper-radio-button.html">
<link rel="import" href="../../../bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="../../../bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../../../bower_components/neon-animation/neon-animatable.html">
<link rel="import" href="../../../bower_components/neon-animation/neon-animations.html">
<link rel="import" href="../../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../../../bower_components/paper-styles/color.html">
<link rel="stylesheet" href="../../../bower_components/paper-styles/color.html">

<dom-module id="question-list">
  <template>

    <style>
      :host {
        display: block;
      }

      .main-container{
        @apply(--layout-fullbleed);
        @apply(--layout-vertical);
      }

      ul {
        padding:1.5% 12px;
      }

      li{
        list-style-type: none;
        margin-bottom: 3%;
      }

      paper-fab.gray {
  			--paper-fab-background: var(--paper-grey-500);
  			--paper-fab-keyboard-focus-background: var(--paper-grey-500);
  		}

      paper-fab.blue {
  			--paper-fab-background: var(--paper-light-blue-500);
  			--paper-fab-keyboard-focus-background: var(--paper-light-blue-500);
  		}

  		paper-toolbar {
  			--paper-toolbar-background: var(--paper-light-blue-500);
  		}

      .customLogo{
        position: absolute;
        right:2%;
        top:30%;
        width:90px;
        height:90px;
        background-color: #fff;
        border-radius: 50%;
        box-shadow: 2px 2px 5px #333;
      }

      neon-animated-pages {
        @apply(--layout-flex);
        @apply(--layout-vertical);
      }

      neon-animatable label{
        display: block;
        text-align: center;
      }

      .container {
        @apply(--layout-flex);
        padding:2%;
      }

      .horizontal {
        @apply(--layout-horizontal);
      }
      .flexchild {
        @apply(--layout-flex);
      }
    </style>

    <!-- paper-header-panel must have an explicit height -->
    <div class="main-container">
      <div>
        <paper-toolbar class="medium-tall">
          <div class="bottom">
            <span class="middle title">Bayer: Science For A Better Life</span>
          </div>
          <img class="customLogo" src="[[logoSrc]]" />
        </paper-toolbar>
      </div>
      <div class="container">
        <form is="iron-form" id="form" class="flex" method="post" action="/form/handler">
          <input type="hidden" name="curdom" id="curdom" value="">
          <neon-animated-pages id="pages" selected="[[selected]]" entry-animation="[[entryAnimation]]" exit-animation="[[exitAnimation]]">
            <neon-animatable>
              <label>[[introTxt]]</label>
            </neon-animatable>
            <template is="dom-repeat" items="[[questions]]" as="question">
              <neon-animatable>
                <label>[[question.label]]</label>
                <template is="dom-if" if="{{isEquals(question.answers[0].type, 'radio')}}">
                  <paper-radio-group>
                    <template is="dom-repeat" items="{{question.answers}}" as="answer">
                      <paper-radio-button name="{{answer.id}}" value="{{answer.value}}">{{answer.text}}</paper-radio-button><br />
                    </template>
                  </paper-radio-group>
                </template>

                <template is="dom-if" if="{{!isEquals(question.answers[0].type, 'radio')}}">
                  <ul>
                    <template is="dom-if" if="{{!isEquals(answer.type, 'radio')}}">
                      <li>
                        <template is="dom-if" if="{{isEquals(answer.type, 'check')}}">
                          <paper-checkbox name="[[answer.id]]" value="[[answer.value]]">[[answer.text]]</paper-checkbox>
                        </template>
                        <template is="dom-if" if="{{!isEquals(answer.type, 'check')}}">
                          <paper-input class="short" name="[[answer.id]]" label="[[answer.text]]" value="[[answer.value]]" type="[[answer.type]]" id="[[answer.id]]"></paper-input>
                        </template>
                      </li>
                    </template>
                  </ul>
                </template>
              </neon-animatable>
            </template>
            <neon-animatable>
              <label>FINE<br />Fai il submit!</label>
            </neon-animatable>
          </neon-animated-pages>
        </form>
      </div>
      <div>
        <div class="horizontal" style="padding:2%;">
          <div><paper-fab disabled="[[isPrevDisabled]]" icon="arrow-back" title="Prev" class="gray" on-tap="onPrevTap"></paper-fab></div>
          <div class="flexchild"></div>
          <div><paper-fab disabled="[[isNextDisabled]]" icon="arrow-forward" title="Next" class="blue" on-tap="onNextTap"></paper-fab></div>
        </div>
      </div>
    </div>
    [[questions.length]]
  </template>
</dom-module>

<script>
  Polymer({
    is: 'question-list',
    properties: {
      logoSrc : {
        type : String,
        notify : true,
        value : ""
      },
      introTxt : {
        type : String,
        notify : true,
        value : ""
      },
      selected : {
        type : Number,
        notify : true,
        value : 0
      },
      isPrevDisabled : {
        type : Boolean,
        computed : 'isEquals(selected, 0)'
      },
      isNextDisabled : {
        type : Boolean,
        computed : 'isGreaterThan(questions.length, selected)'
      },
      entryAnimation : {
        type : String,
        notify : true
      },
      exitAnimation : {
        type : String,
        notify : true
      },
      questions : {
        type : Array,
        notify : true,
        value : []
      },
    },

    ready: function() {
      this.totalQuestions = this.querySelectorAll('neon-animatable').length - 1;
    },

    isEquals : function(value, valueToEqual){
      console.log(value, valueToEqual, value === valueToEqual);
      return value === valueToEqual;
    },

    isGreaterThan : function(value, valueToEqual){
      return value < valueToEqual;
    },

    onPrevTap : function() {
      this.entryAnimation = 'slide-from-left-animation';
      this.exitAnimation = 'slide-right-animation';
      if (this.selected !== 0){
        this.selected = this.selected - 1;
      }
    },

    onNextTap : function() {
      this.entryAnimation = 'slide-from-right-animation';
      this.exitAnimation = 'slide-left-animation';
      if (this.selected !== (this.questions.length + 1)){
        this.selected = this.selected + 1;
      }
    }
  });
</script>
